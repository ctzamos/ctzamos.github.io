---
layout: default
---
<h1>Generate unique passwords using a master password</h1>
&lt; <a href="/">Back to home</a><br/><br/>

<p>
Inspired by the password generator of <a href="https://chriszarate.github.io/supergenpass/">Chris Zarate</a>, I created a bookmarklet that generates unique passwords for websites based on md5 hashing of a master password. It is a simplified version made specifically to not require external libraries like jquery or communication with a server. It uses md5 from <a href="https://github.com/jbt/js-crypto">js-crypto</a>.
<b>Use with caution!</b>
</p>
<p>
<a href="javascript:void%20function(){var%20t=location.protocol+%22//%22+location.hostname+(location.port%3F%22:%22+location.port:%22%22),e=window.addEventListener%3F%22addEventListener%22:%22attachEvent%22,n=%22%3Cstyle%3E%20form{margin:0;}%20input{display:block;padding:4px;margin:5px%200;width:100%25;}%20div{background:%23fa0;height:20px;margin-top:5px;padding:2px;}%20button{display:inline-block;color:white;height:20px;%20background:brown;outline:none;border:none;width:30%25;}%20%3C/style%3E%20%3Cform%20id='f'%3E%20%3Cinput%20type='text'%20value='%22+document.domain+%22'%3E%3Cinput%20type='password'%20placeholder='pwd'%3E%20%3Cbutton%20type='submit'%3Elogin%3C/button%3E%20%3Cbutton%20type='button'%20onclick='javascript:show()'%3Eshow%3C/button%3E%20%3Cbutton%20type='button'%20onclick='javascript:done()'%3Eclose%3C/button%3E%20%3Cdiv%3E%3C/div%3E%20%3C/form%3E%20%3Cscript%3E%20z=document;d=%20document.getElementsByTagName('div')[0];%20md5=function(){for(var%20m=[],l=0;64%3El;)m[l]=0|4294967296*Math.abs(Math.sin(++l));return%20function(c){var%20e,g,f,a,h=[];c=unescape(encodeURI(c));for(var%20b=c.length,k=[e=1732584193,g=-271733879,~e,~g],d=0;d%3C=b;)h[d%3E%3E2]|=(c.charCodeAt(d)||128)%3C%3C8*(d++%254);h[c=16*(b+8%3E%3E6)+14]=8*b;for(d=0;d%3Cc;d+=16){b=k;for(a=0;64%3Ea;)b=[f=b[3],(e=b[1]|0)+((f=b[0]+[e%26(g=b[2])|~e%26f,f%26e|~f%26g,e^g^f,g^(e|~f)][b=a%3E%3E4]+(m[a]+(h[[a,5*a+1,3*a+5,7*a][b]%2516+d]|0)))%3C%3C(b=[7,12,17,22,5,9,14,20,4,11,16,23,6,10,15,21][4*b+a++%254])|f%3E%3E%3E32-b),e,g];for(a=4;a;)k[--a]=k[a]+b[a]}for(c='';32%3Ea;)c+=(k[a%3E%3E3]%3E%3E4*(1^a++%267)%2615).toString(16);return%20c}}();%20function%20compute()%20{i=%20document.getElementsByTagName('input');%20return%20md5(i[0].value+'%23'+i[1].value).substr(0,12)+'a1A.';%20}%20function%20send(e){if(e.preventDefault)%20e.preventDefault();%20d.innerHTML='*****';%20parent.postMessage(compute(),'%22+t+%22');%20return%20false;%20}%20function%20done(){parent.postMessage('x','%22+t+%22');%20}%20function%20show(){d.innerHTML=compute();%20}%20form=%20document.getElementById('f');%20form['%22+e+%22']('submit',send);%20%3C/script%3E%22,o=document.createElement(%22iframe%22);o.src=%22data:text/html;charset=utf-8,%22+encodeURI(n),o.style=%22position:fixed;top:10px;right:10px;z-index:1234567890;background:gold;width:200px;height:130px;border:0;box-shadow:%200%200%2010px%20black;%22,document.body.appendChild(o);var%20a=window[e],d=%22attachEvent%22==e%3F%22onmessage%22:%22message%22;a(d,function(t){var%20e=t.data;if(%22x%22==e)return%20void%20document.body.removeChild(o);for(var%20n=document.getElementsByTagName(%22input%22),a=0;a%3Cn.length;a++)%22password%22===n[a].type.toLowerCase()%26%26(n[a].focus(),n[a].value=e)},!1)}();"style="display: block; background: lightyellow; max-width: 200px; padding: 10px; border: 1px solid #ccc;">
  Login</a>
</p>
<p>
  Get it by dragging the link to your bookmarks bar. Below is the source code for convenience. It computes a hash using the following formula:
"md5(domain#pass)a1A.". The md5 is truncated to 12 characters to give a 16 character password in total.
</p>

{% highlight javascript %}
var d = location.protocol+'//'+location.hostname+(location.port?':'+location.port: '');
var eventMethod = window.addEventListener ? "addEventListener" : "attachEvent";
var html = 
 "<style>\
    form{margin:0;}\
    input{display:block;padding:4px;margin:5px 0;width:100%;}\
    div{background:#fa0;height:20px;margin-top:5px;padding:2px;}\
    button{display:inline-block;color:white;height:20px;\
      background:brown;outline:none;border:none;width:30%;}\
  </style>\
  <form id='f'>\
    <input type='text' value='"+ document.domain+"'><input type='password' placeholder='pwd'>\
    <button type='submit'>login</button>\
    <button type='button' onclick='javascript:show()'>show</button>\
    <button type='button' onclick='javascript:done()'>close</button>\
    <div></div>\
  </form>\
  <sc"+"ript>\
    z=document;d= document.getElementsByTagName('div')[0];\
    md5=function(){for(var m=[],l=0;64>l;)m[l]=0|4294967296*Math.abs(Math.sin(++l));return function(c){var e,g,f,a,h=[];c=unescape(encodeURI(c));for(var b=c.length,k=[e=1732584193,g=-271733879,~e,~g],d=0;d<=b;)h[d>>2]|=(c.charCodeAt(d)||128)<<8*(d++%4);h[c=16*(b+8>>6)+14]=8*b;for(d=0;d<c;d+=16){b=k;for(a=0;64>a;)b=[f=b[3],(e=b[1]|0)+((f=b[0]+[e&(g=b[2])|~e&f,f&e|~f&g,e^g^f,g^(e|~f)][b=a>>4]+(m[a]+(h[[a,5*a+1,3*a+5,7*a][b]%16+d]|0)))<<(b=[7,12,17,22,5,9,14,20,4,11,16,23,6,10,15,21][4*b+a++%4])|f>>>32-b),e,g];for(a=4;a;)k[--a]=k[a]+b[a]}for(c='';32>a;)c+=(k[a>>3]>>4*(1^a++&7)&15).toString(16);return c}}();\
    function compute() {\
      i= document.getElementsByTagName('input');\
      return md5(i[0].value+'#'+i[1].value).substr(0,12)+'a1A.';\
    }\
    function send(e){\
      if(e.preventDefault) e.preventDefault();\
      d.innerHTML='*****';\
      parent.postMessage(compute(),'"+d+"');\
      return false;\
    }\
    function done(){\
      parent.postMessage('x','"+d+"');\
    }\
    function show(){\
      d.innerHTML=compute();\
    }\
    form= document.getElementById('f');\
    form['"+eventMethod+"']('submit',send);\
  </"+"script>";
var iframe =  document.createElement('iframe');
iframe.src = 'data:text/html;charset=utf-8,' + encodeURI(html);
iframe.style = 'position:fixed;top:10px;right:10px;z-index:1234567890;background:gold;width:200px;height:130px;border:0;box-shadow: 0 0 10px black;';
 document.body.appendChild(iframe);
var eventer = window[eventMethod];
var messageEvent = eventMethod == "attachEvent" ? "onmessage" : "message";
eventer(messageEvent,function(e) {
  var m = e.data;
  if(m=='x') { document.body.removeChild( iframe );return;}
  var inputs =  document.getElementsByTagName("input");
  for (var i=0; i<inputs.length; i++) {
    if (inputs[i].type.toLowerCase() === "password") {
      inputs[i].focus();
      inputs[i].value = m;
    }
  }
},false);
{% endhighlight %}
